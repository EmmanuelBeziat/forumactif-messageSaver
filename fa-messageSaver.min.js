"use strict";
/*!
 * Nom: fa-messageSaver
 * Version: 1.2
 * Description: Permet l'enregistrement automatique des messages dans les champs de post de forumactif
 * Auteur: Emmanuel Beziat
 * GitHub: https://github.com/EmmanuelBeziat/forumactif-messageSaver
 */var messageSaver=function(r){var u=function(e,a,t,r){var n=localStorage.getItem(t);if("undefined"==n)return!1;var o=JSON.parse(n);return o.userID===e&&o.topicURL===r&&""===a};return{init:function(){var n=window.location.host,o=_userdata.user_id,s=function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var a=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(window.location.href),t=r("#text_editor_textarea").siblings('input[name="'+e+'"]').val();return null===a?t:a[1]}("t"),e=r('form[action="/post"]'),a=e.find('input[name="post"]'),i=r("#text_editor_textarea").sceditor("instance");i.bind("keyup",function(){var e,a,t,r;e=o,a=i.val(),t=n,r={userID:e,topicURL:s,message:a},localStorage.setItem(t,JSON.stringify(r))}),localStorage.getItem(n)&&a.before('<input type="button" class="mainoption btn-loader" id="ms-loader" value="Charger le message sauvegardé" />&nbsp&nbsp'),e.on("click","#ms-loader",function(){!function(e,a,t,r){var n=localStorage.getItem(t);if("undefined"!=n){var o=JSON.parse(n);u(e,a.val(),t,r)?a.val(o.message):alert("Erreur 1: La vérification du message enregistré a échoué.")}else alert("Erreur 2: Il n’y a aucun message sauvegardé.")}(o,i,n,s)})}}}(jQuery);$(window).load(function(){"undefined"==typeof _userdata?console.log('L’objet "_userdata" de forumactif n’a pas été trouvé. Le script de sauvegarde des messages en cours d’écriture ne peut pas fonctionner.'):messageSaver.init()});